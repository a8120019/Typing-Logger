<!DOCTYPE html>

<html>

<head>
	<link rel="stylesheet" href="index.css">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

	<script type="text/javascript" src="lib/jquery.min.js"></script>
	<script type="text/javascript" src="lib/osql.js"></script>

	<script>
		osql.requireLogin();
		var startLogging = false;
		var keyLogs = [];
		document.addEventListener("keypress", keyPressEvent);

		$(document).ready(function () {
			// functions
		});

		function keyPressEvent(e) {
			if (e.keyCode == 32 && startLogging == false) {  // Spaceを押した際の処理
				// log取得開始の合図
				startLogging = true;
				// textareaの内容を空に
				var typefield = document.getElementById("typingfield");
				typefield.value = "";
				// textareaの編集を可能に
				typefield.readOnly = false;
				// textareaにフォーカスを合わせる
				typefield.focus();
				var key_type = e.code;
				var now = new Date();
				var key_time = now.getTime();
			} else if (startLogging == true) {  // 計測開始後の処理
				var key_type = e.key;
				var now = new Date();
				var key_time = now.getTime();
			}
			if (key_type) {  // キーが計測されていた場合の処理
				var key_dict = {};
				key_dict.key = key_type;
				key_dict.time = key_time;

				keyLogs.push(key_dict);
			}
		}

		function buttonPressed() {
			// ログ確認
			console.log(keyLogs);
		}

	</script>

</head>

<body>
	<h1>タイピングページ</h1>
	ジムで体を鍛えているよ
	<br>
	ZIMUDEKARADAWOKITAETEIRUYO
	<br>
	<br>

	豆腐は大豆からできています
	<br>
	TOUHUHADAIZUKARADEKITEIMASU
	<br>
	<br>

	リビングにジャニーズのポスターを貼る
	<br>
	RIBINNGUNIJYANI-ZUNOPOSUTA-WOHARU
	<br>
	<br>

	If you understand this question please call me
	<br>
	IF YOU UNDERSTAND THIS QUESTION PLEASE CALL ME
	<br>
	<br>

	<textarea id="typingfield" rows="4" cols="100" readonly>SPACEを押すと開始します</textarea>
	<button onclick="buttonPressed()">送信</button>

</body>

</html>